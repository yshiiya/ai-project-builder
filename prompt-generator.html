<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Project ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media (min-width: 768px) {
            .container {
                max-width: 1200px;
            }
        }
        .preview-box {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
        }
        .task-type-card {
            position: relative;
        }
        .task-type-card.ring-2 {
            animation: pulse-ring 2s ease-in-out;
        }
        @keyframes pulse-ring {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.5);
            }
            50% {
                box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.2);
            }
        }
        
        /* å¿…é ˆé …ç›®ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .required-label::after {
            content: "ï¼ˆå¿…é ˆï¼‰";
            color: #ef4444;
            font-weight: normal;
            font-size: 0.875rem;
        }
        
        .required-field {
            border-left: 3px solid #ef4444;
        }
        
        .required-notice {
            background-color: #fef2f2;
            border: 1px solid #fecaca;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            color: #991b1b;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-xl md:text-2xl font-bold">AI Project ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
                    <p class="text-xs md:text-sm opacity-90 mt-1 hidden md:block">ã‚¿ã‚¹ã‚¯ã«æœ€é©åŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ</p>
                </div>
                <div class="flex gap-2 items-center">
                    <a href="index.html" class="px-3 py-1.5 bg-white text-blue-600 rounded hover:bg-gray-100 transition-colors font-medium text-xs shadow-md md:text-sm md:px-4 md:py-2 md:rounded-lg">
                        â† åŸºæœ¬æŒ‡ç¤ºã¸
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Basic Instructions Notice -->
        <div id="basicInstructionsNotice" class="hidden mb-6 p-4 bg-blue-100 border border-blue-300 rounded-lg">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-blue-800">
                        <span class="font-medium">ğŸ“‹ åŸºæœ¬æŒ‡ç¤ºãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ:</span>
                        <span id="loadedProjectName" class="ml-2"></span>
                    </p>
                    <p id="projectTypeInfo" class="text-sm text-blue-700 mt-1"></p>
                </div>
                <div id="recommendedTasksBadge" class="hidden text-sm bg-blue-200 text-blue-800 px-3 py-1 rounded-full">
                    <span id="projectTypeLabel"></span>ã®æ¨å¥¨ã‚¿ã‚¹ã‚¯
                </div>
            </div>
        </div>
        
        <!-- Usage Guide -->
        <div class="mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg">
            <p class="text-sm text-amber-800">
                ğŸ’¡ <strong>é€šå¸¸ã®ä½¿ã„æ–¹ï¼š</strong>
                åŸºæœ¬æŒ‡ç¤ºã‚’è¨­å®šæ¸ˆã¿ã®å ´åˆã¯ã€ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ï¼ˆåˆ†æãƒ»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆãªã©ï¼‰ã‚’é¸ã‚“ã§å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
                ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ã¯ã€æœ¬æ ¼çš„ãªè¨ˆç”»ç«‹æ¡ˆãŒå¿…è¦ãªå ´åˆã®ã¿ã”åˆ©ç”¨ãã ã•ã„ã€‚
            </p>
        </div>

        <div class="grid md:grid-cols-2 gap-8">
            <!-- Left Column: Task Input -->
            <div class="space-y-6">
                <!-- Task Type Selection -->
                <div class="bg-white rounded-lg shadow-md p-4">
                    <h3 class="font-bold text-base mb-3 flex items-center gap-2 required-label">
                        <span class="text-lg">ğŸ¯</span> ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’é¸æŠ
                    </h3>
                    
                    <div class="grid grid-cols-3 md:grid-cols-4 gap-2">
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="project-plan" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="project-plan">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">ğŸ“‹</div>
                                <div class="text-sm font-medium">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ<br>è¨ˆç”»</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="analysis" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="analysis">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">ğŸ“Š</div>
                                <div class="text-sm font-medium">åˆ†æãƒ»èª¿æŸ»</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="creation" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="creation">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">âœï¸</div>
                                <div class="text-sm font-medium">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„<br>ä½œæˆ</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="coding" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="coding">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">ğŸ’»</div>
                                <div class="text-sm font-medium">ã‚³ãƒ¼ãƒ‰é–‹ç™º</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="brainstorm" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="brainstorm">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">ğŸ’¡</div>
                                <div class="text-sm font-medium">ã‚¢ã‚¤ãƒ‡ã‚¢<br>å‡ºã—</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="review" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="review">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">ğŸ”</div>
                                <div class="text-sm font-medium">ãƒ¬ãƒ“ãƒ¥ãƒ¼<br>è©•ä¾¡</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="troubleshoot" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="troubleshoot">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">ğŸ”§</div>
                                <div class="text-sm font-medium">å•é¡Œè§£æ±º</div>
                            </div>
                        </label>
                        
                        <label class="cursor-pointer relative">
                            <input type="radio" name="taskType" value="custom" class="sr-only peer">
                            <div class="task-type-card p-2 border border-gray-200 rounded hover:border-blue-400 peer-checked:border-blue-500 peer-checked:bg-blue-50 transition-all text-center" data-task-type="custom">
                                <div class="recommended-badge hidden absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full text-xs">æ¨å¥¨</div>
                                <div class="text-2xl mb-1">âš™ï¸</div>
                                <div class="text-sm font-medium">ã‚«ã‚¹ã‚¿ãƒ </div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Task Details -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                        <span class="text-xl" id="detailsIcon">ğŸ“</span> <span id="detailsTitle">ã‚¿ã‚¹ã‚¯ã®è©³ç´°</span>
                    </h3>
                    
                    <!-- Regular Task Form -->
                    <div id="regularTaskForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 required-label">ã‚¿ã‚¹ã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«</label>
                            <input type="text" id="taskTitle" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 required-field"
                                   placeholder="ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã™ã‚‹ã¨ã€é©åˆ‡ãªä¾‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"
                                   required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1 required-label">å…·ä½“çš„ãªã‚¿ã‚¹ã‚¯å†…å®¹</label>
                            <textarea id="taskDescription" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-32 required-field"
                                      placeholder="ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã™ã‚‹ã¨ã€é©åˆ‡ãªä¾‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"
                                      required></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">æœŸå¾…ã™ã‚‹æˆæœç‰©</label>
                            <textarea id="expectedOutput" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-24"
                                      placeholder="ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã™ã‚‹ã¨ã€é©åˆ‡ãªä¾‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"
                                      onchange="generatePrompt()"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å‚è€ƒæƒ…å ±ãƒ»ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</label>
                            <textarea id="context" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-20"
                                      placeholder="ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã™ã‚‹ã¨ã€é©åˆ‡ãªä¾‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"
                                      onchange="generatePrompt()"></textarea>
                        </div>
                    </div>
                    
                    <!-- Project Start Form -->
                    <div id="projectStartForm" class="space-y-4 hidden">
                        <!-- å¿…é ˆé …ç›®ã®èª¬æ˜ -->
                        <div class="required-notice">
                            <strong>â€» å¿…é ˆé …ç›®</strong>ï¼šåŸºæœ¬æŒ‡ç¤ºãƒ“ãƒ«ãƒ€ãƒ¼ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„ãƒ»ã‚´ãƒ¼ãƒ«ã®è¨­å®šãŒå¿…è¦ã§ã™
                        </div>
                        
                        <!-- Examples Section -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                            <h4 class="font-medium text-blue-900 mb-2">ğŸ’¡ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¾‹</h4>
                            <ul class="text-sm text-blue-800 space-y-1">
                                <li>â€¢ <strong>å—é¨“å¯¾ç­–</strong>: å¿—æœ›æ ¡ã€ç¾åœ¨ã®æˆç¸¾ã€è‹¦æ‰‹ç§‘ç›®ã€äºˆç®—ãªã©</li>
                                <li>â€¢ <strong>ä½å®…è³¼å…¥</strong>: å¸Œæœ›ã‚¨ãƒªã‚¢ã€äºˆç®—ã€å®¶æ—æ§‹æˆã€å¿…é ˆæ¡ä»¶ãªã©</li>
                                <li>â€¢ <strong>å•†å“é–‹ç™º</strong>: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ã€ç«¶åˆå•†å“ã€äºˆç®—ã€è²©å£²ç›®æ¨™ãªã©</li>
                                <li>â€¢ <strong>ã‚¤ãƒ™ãƒ³ãƒˆä¼ç”»</strong>: è¦æ¨¡ã€äºˆç®—ã€å¯¾è±¡è€…ã€ä¼šå ´æ¡ä»¶ãªã©</li>
                            </ul>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">æœŸé™ãƒ»ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³</label>
                            <input type="text" id="projectDeadline" 
                                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                   placeholder="ä¾‹: æ¥å¹´3æœˆã®å—é¨“æ—¥ã¾ã§ã€åŠå¹´ä»¥å†…ã«è³¼å…¥ã€å¹´æœ«å•†æˆ¦ã«å‘ã‘ã¦ãªã©"
                                   onchange="generatePrompt()">
                        </div>
                        
                        <div id="agentTasksSection" class="space-y-3">
                            <label class="block text-sm font-medium text-gray-700">ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåˆ¥ã‚¿ã‚¹ã‚¯</label>
                            <div id="agentTasksList" class="space-y-2">
                                <!-- Dynamically populated agent tasks -->
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ãƒ»æº–å‚™</label>
                            <textarea id="techRequirements" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-20"
                                      placeholder="ä¾‹: å‚è€ƒæ›¸ã‚„å•é¡Œé›†ã€ä¸å‹•ç”£ä¼šç¤¾ã®é¸å®šã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°äºˆç®—ã€å¿…è¦ãªäººæãªã©"
                                      onchange="generatePrompt()"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">æ³¨æ„ç‚¹ãƒ»åˆ¶ç´„äº‹é …</label>
                            <textarea id="projectConstraints" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-20"
                                      placeholder="ä¾‹: äºˆç®—ã®ä¸Šé™ã€å®Ÿæ–½æœŸé™ã€ä½¿ç”¨å¯èƒ½ãªæ™‚é–“ã€é¿ã‘ã‚‹ã¹ããƒªã‚¹ã‚¯ãªã©"
                                      onchange="generatePrompt()"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å‚è€ƒè³‡æ–™ãƒ»ãƒªãƒ³ã‚¯</label>
                            <textarea id="projectReferences" 
                                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-20"
                                      placeholder="ä¾‹: ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«: figma.com/..."
                                      onchange="generatePrompt()"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Additional Options -->
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                        <span class="text-xl">âš™ï¸</span> è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³
                    </h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="includeBasicInstructions" class="mr-3 h-5 w-5" checked onchange="generatePrompt()">
                                <div>
                                    <span class="font-medium">åŸºæœ¬æŒ‡ç¤ºã‚’å«ã‚ã‚‹</span>
                                    <span class="text-sm text-gray-500 block">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åŸºæœ¬è¨­å®šã‚’å‚ç…§ã™ã‚‹</span>
                                </div>
                            </label>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å„ªå…ˆåº¦</label>
                            <select id="priority" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" onchange="generatePrompt()">
                                <option value="normal">é€šå¸¸</option>
                                <option value="high">é«˜ï¼ˆæ€¥ãï¼‰</option>
                                <option value="low">ä½ï¼ˆæ™‚é–“ãŒã‚ã‚‹æ™‚ã«ï¼‰</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-4">
                    <button onclick="generatePrompt()" 
                            class="flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all font-medium shadow-md">
                        ğŸ”„ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å†ç”Ÿæˆ
                    </button>
                    <button onclick="saveTask()" 
                            class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium">
                        ğŸ’¾ ä¿å­˜
                    </button>
                </div>
            </div>

            <!-- Right Column: Generated Prompt -->
            <div class="sticky top-8">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-lg">ğŸ¤– ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</h3>
                        <button id="copyBtn" onclick="copyPrompt()" 
                                class="px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"
                                disabled>
                            ğŸ“‹ ã‚³ãƒ”ãƒ¼
                        </button>
                    </div>
                    
                    <div id="promptPreview" class="preview-box rounded-lg p-4 min-h-[400px] max-h-[600px] overflow-y-auto">
                        <p class="text-gray-500 text-center">ã‚¿ã‚¹ã‚¯æƒ…å ±ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã“ã“ã«æœ€é©åŒ–ã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
                    </div>
                    
                    <!-- Dynamic Usage Guide -->
                    <div id="usageGuideSection" class="mt-4 p-4 bg-blue-50 rounded-lg hidden">
                        <h4 class="font-medium text-blue-900 mb-2">
                            ğŸ“Œ ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ä½¿ã„æ–¹
                        </h4>
                        <div id="usageGuide" class="text-sm text-blue-800">
                            <!-- Dynamically populated based on task type -->
                        </div>
                    </div>
                    
                    <!-- Default Hint -->
                    <div id="defaultHint" class="mt-4 p-3 bg-blue-50 rounded-lg">
                        <p class="text-sm text-blue-800">
                            ğŸ’¡ <strong>ãƒ’ãƒ³ãƒˆ:</strong> ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯Claudeã‚„ChatGPTã«ç›´æ¥ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã§ãã¾ã™
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // State management
        let taskData = {
            type: '',
            title: '',
            description: '',
            expectedOutput: '',
            context: '',
            priority: 'normal',
            includeBasicInstructions: true
        };

        let basicInstructions = null;
        
        // Usage guides for each task type
        const usageGuides = {
            'project-plan': {
                title: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ã®ä½¿ã„æ–¹',
                steps: [
                    'Claudeãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ–°ã—ã„ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹',
                    'ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ãã®ã¾ã¾é€ä¿¡',
                    'ClaudeãŒè©³ç´°ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ã‚’ä½œæˆ',
                    'ç”Ÿæˆã•ã‚ŒãŸè¨ˆç”»ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã—ã¦ä¿å­˜',
                    'å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã¯ã‚¿ã‚¹ã‚¯ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã§å®Ÿè¡Œ'
                ],
                tip: 'ğŸ’¡ æœ¬æ ¼çš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ãŒå¿…è¦ãªå ´åˆã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚é€šå¸¸ã¯åŸºæœ¬æŒ‡ç¤ºï¼‹ã‚¿ã‚¹ã‚¯ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ååˆ†ã§ã™ã€‚'
            },
            'analysis': {
                title: 'åˆ†æã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'æ—¢å­˜ã¾ãŸã¯æ–°è¦ã®ãƒãƒ£ãƒƒãƒˆã§ä½¿ç”¨',
                    'ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡',
                    'ClaudeãŒæŒ‡å®šã•ã‚ŒãŸåˆ†æã‚’å®Ÿè¡Œ'
                ],
                tip: 'ğŸ’¡ åŸºæœ¬æŒ‡ç¤ºãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã°ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ–‡è„ˆã‚’ä¿æŒã—ãŸã¾ã¾åˆ†æãŒè¡Œã‚ã‚Œã¾ã™ã€‚'
            },
            'creation': {
                title: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'ãƒãƒ£ãƒƒãƒˆã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡',
                    'ClaudeãŒè¦ä»¶ã«æ²¿ã£ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½œæˆ',
                    'å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã‚’ä¾é ¼'
                ],
                tip: 'ğŸ’¡ åŸºæœ¬æŒ‡ç¤ºã§è¨­å®šã—ãŸãƒˆãƒ¼ãƒ³ã‚„å½¢å¼ãŒè‡ªå‹•çš„ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚'
            },
            'coding': {
                title: 'ã‚³ãƒ¼ãƒ‰é–‹ç™ºã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'é–‹ç™ºç’°å¢ƒã®æƒ…å ±ã¨å…±ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡',
                    'ClaudeãŒã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ',
                    'ã‚³ãƒ¼ãƒ‰ã‚’ãƒ†ã‚¹ãƒˆã—ã¦å¿…è¦ã«å¿œã˜ã¦èª¿æ•´'
                ],
                tip: 'ğŸ’¡ åŸºæœ¬æŒ‡ç¤ºã§æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã‚’è¨­å®šã—ã¦ã„ã‚Œã°ã€ãã‚Œã«æº–æ‹ ã—ãŸã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚'
            },
            'brainstorm': {
                title: 'ã‚¢ã‚¤ãƒ‡ã‚¢å‡ºã—ã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡ã—ã¦ãƒ–ãƒ¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒŸãƒ³ã‚°é–‹å§‹',
                    'ClaudeãŒè¤‡æ•°ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ææ¡ˆ',
                    'æ°—ã«å…¥ã£ãŸã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ·±æ˜ã‚Š'
                ],
                tip: 'ğŸ’¡ å‰µé€ çš„ãªç™ºæƒ³ã‚’ä¿ƒã™ãŸã‚ã€åˆ¶ç´„ã¯æœ€å°é™ã«ç•™ã‚ã¾ã—ã‚‡ã†ã€‚'
            },
            'review': {
                title: 'ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡ã¨å…±ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡',
                    'ClaudeãŒè©³ç´°ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’æä¾›',
                    'æ”¹å–„æ¡ˆã«åŸºã¥ã„ã¦ä¿®æ­£'
                ],
                tip: 'ğŸ’¡ å…·ä½“çš„ãªè©•ä¾¡åŸºæº–ã‚’å«ã‚ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šæœ‰ç›Šãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚'
            },
            'custom': {
                title: 'ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡',
                    'ClaudeãŒã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ',
                    'çµæœã‚’ç¢ºèªã—ã¦å¿…è¦ã«å¿œã˜ã¦èª¿æ•´'
                ],
                tip: 'ğŸ’¡ ç‰¹æ®Šãªã‚¿ã‚¹ã‚¯ã®å ´åˆã¯ã€å…·ä½“ä¾‹ã‚’å«ã‚ã‚‹ã¨ç†è§£ã•ã‚Œã‚„ã™ããªã‚Šã¾ã™ã€‚'
            },
            'troubleshoot': {
                title: 'å•é¡Œè§£æ±ºã‚¿ã‚¹ã‚¯ã®ä½¿ã„æ–¹',
                steps: [
                    'ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚„å•é¡Œã®è©³ç´°ã¨å…±ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡',
                    'ClaudeãŒåŸå› åˆ†æã¨è§£æ±ºç­–ã‚’æç¤º',
                    'ææ¡ˆã•ã‚ŒãŸè§£æ±ºç­–ã‚’è©¦ã—ã¦çµæœã‚’ç¢ºèª',
                    'å¿…è¦ã«å¿œã˜ã¦è¿½åŠ ã®è³ªå•ã‚„èª¿æ•´ã‚’ä¾é ¼'
                ],
                tip: 'ğŸ’¡ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯çœç•¥ã›ãšã€å®Œå…¨ãªå½¢ã§æä¾›ã™ã‚‹ã¨ã€ã‚ˆã‚Šæ­£ç¢ºãªè§£æ±ºç­–ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚'
            }
        };

        // Project type to task type mapping
        const projectTaskMapping = {
            'business': {
                recommended: ['analysis', 'creation', 'troubleshoot'],
                description: 'ãƒ“ã‚¸ãƒã‚¹ç³»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
            },
            'creative': {
                recommended: ['creation', 'brainstorm', 'review'],
                description: 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ç³»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
            },
            'technical': {
                recommended: ['troubleshoot', 'coding', 'analysis'],
                description: 'æŠ€è¡“ç³»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
            },
            'research': {
                recommended: ['analysis', 'review', 'troubleshoot'],
                description: 'ç ”ç©¶ç³»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
            },
            'education': {
                recommended: ['creation', 'analysis', 'brainstorm'],
                description: 'æ•™è‚²ç³»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
            },
            'personal': {
                recommended: ['brainstorm', 'creation', 'troubleshoot'],
                description: 'å€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
            }
        };

        // Task type placeholders
        const taskPlaceholders = {
            'analysis': {
                title: 'ä¾‹: ç«¶åˆä»–ç¤¾ã®ä¾¡æ ¼æˆ¦ç•¥åˆ†æ',
                description: 'ä¾‹: ä¸»è¦3ç¤¾ï¼ˆAç¤¾ã€Bç¤¾ã€Cç¤¾ï¼‰ã®éå»1å¹´é–“ã®ä¾¡æ ¼æˆ¦ç•¥ã‚’åˆ†æã—ã€å¸‚å ´ã§ã®ä½ç½®ã¥ã‘ã¨ä»Šå¾Œã®å‹•å‘ã‚’äºˆæ¸¬ã€‚è‡ªç¤¾ã®ä¾¡æ ¼æˆ¦ç•¥ã¸ã®æè¨€ã‚’ã¾ã¨ã‚ã‚‹ã€‚',
                expectedOutput: 'ä¾‹: 1. ç«¶åˆ3ç¤¾ã®ä¾¡æ ¼æ¨ç§»ã‚°ãƒ©ãƒ•\n2. ä¾¡æ ¼æˆ¦ç•¥ã®æ¯”è¼ƒè¡¨\n3. å¸‚å ´å‹•å‘åˆ†æãƒ¬ãƒãƒ¼ãƒˆ\n4. è‡ªç¤¾ã¸ã®æè¨€æ›¸ï¼ˆ3ã¤ä»¥ä¸Šã®å…·ä½“æ¡ˆï¼‰',
                context: 'ä¾‹: å‰å››åŠæœŸã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã€å¸‚å ´èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆã®URLã€æ¥­ç•Œãƒ¬ãƒãƒ¼ãƒˆç­‰'
            },
            'creation': {
                title: 'ä¾‹: æ–°å•†å“ç´¹ä»‹ãƒ–ãƒ­ã‚°è¨˜äº‹ä½œæˆ',
                description: 'ä¾‹: 20ä»£å¥³æ€§å‘ã‘ã®æ–°ã‚¹ã‚­ãƒ³ã‚±ã‚¢å•†å“ã«ã¤ã„ã¦ã€è¦ªã—ã¿ã‚„ã™ãå°‚é–€æ€§ã®ã‚ã‚‹ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’ä½œæˆã€‚SEOã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€Œæ•æ„Ÿè‚Œ ã‚¹ã‚­ãƒ³ã‚±ã‚¢ã€ã‚’è‡ªç„¶ã«å«ã‚ã‚‹ã€‚',
                expectedOutput: 'ä¾‹: 1. ãƒ–ãƒ­ã‚°è¨˜äº‹ï¼ˆ1500-2000æ–‡å­—ï¼‰\n2. è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆï¼ˆ3ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰\n3. SNSæŠ•ç¨¿æ–‡ï¼ˆTwitter/Instagramï¼‰',
                context: 'ä¾‹: å•†å“è©³ç´°è³‡æ–™ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ã®è©³ç´°ã€ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ç­‰'
            },
            'coding': {
                title: 'ä¾‹: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã®å®Ÿè£…',
                description: 'ä¾‹: Next.js 14ã§JWTèªè¨¼ã‚’ä½¿ç”¨ã—ãŸãƒ­ã‚°ã‚¤ãƒ³/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å¾“ã„ã€ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚‚å«ã‚ã‚‹ã€‚',
                expectedOutput: 'ä¾‹: 1. èªè¨¼é–¢é€£ã®APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ\n2. èªè¨¼ãƒ•ãƒƒã‚¯ï¼ˆuseAuthï¼‰\n3. ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¨­å®š\n4. å®Ÿè£…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ',
                context: 'ä¾‹: æ—¢å­˜ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆã€ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸€è¦§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒç­‰'
            },
            'brainstorm': {
                title: 'ä¾‹: æ–°ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒãƒ¼ãƒŸãƒ³ã‚°æ¡ˆ',
                description: 'ä¾‹: AIæ´»ç”¨ã®è‹±èªå­¦ç¿’ã‚¢ãƒ—ãƒªã®åç§°ã‚’è€ƒæ¡ˆã€‚è¦šãˆã‚„ã™ãã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹ã‚‚è¦–é‡ã«å…¥ã‚ŒãŸåå‰ã‚’10æ¡ˆä»¥ä¸Šææ¡ˆã€‚',
                expectedOutput: 'ä¾‹: 1. ãƒãƒ¼ãƒŸãƒ³ã‚°æ¡ˆãƒªã‚¹ãƒˆï¼ˆå„æ¡ˆã®èª¬æ˜ä»˜ãï¼‰\n2. å•†æ¨™èª¿æŸ»ã®æ¨å¥¨äº‹é …\n3. ãƒ‰ãƒ¡ã‚¤ãƒ³å–å¾—å¯èƒ½æ€§ã®ç¢ºèªæ–¹æ³•',
                context: 'ä¾‹: ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ã‚»ãƒ—ãƒˆã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå±¤ã€ç«¶åˆã‚µãƒ¼ãƒ“ã‚¹åã€é¿ã‘ãŸã„å°è±¡ç­‰'
            },
            'review': {
                title: 'ä¾‹: APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼',
                description: 'ä¾‹: æ–°è¦é–‹ç™ºã—ãŸREST APIã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€‚é–‹ç™ºè€…è¦–ç‚¹ã§ã®ä½¿ã„ã‚„ã™ã•ã€æƒ…å ±ã®éä¸è¶³ã€æ”¹å–„ç‚¹ã‚’æŒ‡æ‘˜ã€‚',
                expectedOutput: 'ä¾‹: 1. ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã‚µãƒãƒªãƒ¼\n2. å…·ä½“çš„ãªæ”¹å–„ææ¡ˆï¼ˆå„ªå…ˆåº¦ä»˜ãï¼‰\n3. è‰¯ã„ç‚¹ã®ãƒªã‚¹ãƒˆ\n4. ä¿®æ­£ä¾‹ã®æç¤º',
                context: 'ä¾‹: APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®URLã€æƒ³å®šåˆ©ç”¨è€…ã€APIã®ç›®çš„ã€å‚è€ƒã«ã—ãŸã„ä»–ç¤¾APIç­‰'
            },
            'custom': {
                title: 'ä¾‹: é¡§å®¢æº€è¶³åº¦èª¿æŸ»ã®è¨­è¨ˆ',
                description: 'ä¾‹: å››åŠæœŸã”ã¨ã®é¡§å®¢æº€è¶³åº¦èª¿æŸ»ã‚’è¨­è¨ˆã€‚å›ç­”ç‡ã‚’é«˜ã‚ã‚‹å·¥å¤«ã¨ã€å‰å›èª¿æŸ»ã¨ã®æ¯”è¼ƒãŒå¯èƒ½ãªè¨­å•ã‚’å«ã‚ã‚‹ã€‚',
                expectedOutput: 'ä¾‹: 1. èª¿æŸ»ç¥¨ï¼ˆ10-15å•ï¼‰\n2. å®Ÿæ–½è¨ˆç”»æ›¸\n3. åˆ†ææ‰‹æ³•ã®ææ¡ˆ',
                context: 'ä¾‹: å‰å›èª¿æŸ»çµæœã€é‡ç‚¹æ”¹å–„é …ç›®ã€èª¿æŸ»äºˆç®—ã€å®Ÿæ–½æ™‚æœŸç­‰'
            },
            'troubleshoot': {
                title: 'ä¾‹: APIã‚¨ãƒ©ãƒ¼ã®åŸå› èª¿æŸ»',
                description: 'ä¾‹: REST APIã§400 Bad Requestã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«JSONãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãé€ä¿¡ã•ã‚Œã¦ã„ã‚‹ã¯ãšã ãŒã€ã‚µãƒ¼ãƒãƒ¼ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‹’å¦ã—ã¦ã„ã‚‹ã€‚',
                expectedOutput: 'ä¾‹: 1. ã‚¨ãƒ©ãƒ¼ã®åŸå› åˆ†æ\n2. å…·ä½“çš„ãªè§£æ±ºæ‰‹é †\n3. ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰ä¾‹\n4. ä»Šå¾Œã®äºˆé˜²ç­–',
                context: 'ä¾‹: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¨æ–‡ã€APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€é€ä¿¡ã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰ã€ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç­‰'
            }
        };

        // Task type templates
        const taskTemplates = {
            'project-plan': {
                name: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»',
                icon: 'ğŸ“‹',
                template: 'è©³ç´°ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ã‚’ç­–å®šã—ã¦ãã ã•ã„',
                structure: ['ç›®æ¨™é”æˆã¾ã§ã®ã‚¹ãƒ†ãƒƒãƒ—', 'é‡è¦ãªæ±ºå®šãƒã‚¤ãƒ³ãƒˆ', 'äºˆæƒ³ã•ã‚Œã‚‹èª²é¡Œã¨å¯¾ç­–', 'ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¡ˆ', 'æˆåŠŸã®æŒ‡æ¨™'],
                isProjectPlan: true
            },
            analysis: {
                name: 'åˆ†æãƒ»èª¿æŸ»',
                icon: 'ğŸ“Š',
                template: 'ä»¥ä¸‹ã«ã¤ã„ã¦è©³ç´°ãªåˆ†æã‚’è¡Œã£ã¦ãã ã•ã„',
                structure: ['ç¾çŠ¶åˆ†æ', 'èª²é¡ŒæŠ½å‡º', 'æ”¹å–„ææ¡ˆ', 'å®Ÿè¡Œè¨ˆç”»']
            },
            creation: {
                name: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ',
                icon: 'âœï¸',
                template: 'ä»¥ä¸‹ã®è¦ä»¶ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½œæˆã—ã¦ãã ã•ã„',
                structure: ['ç›®çš„ã¨å¯¾è±¡èª­è€…', 'ä¸»è¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸', 'æ§‹æˆæ¡ˆ', 'ãƒˆãƒ¼ãƒ³è¨­å®š']
            },
            coding: {
                name: 'ã‚³ãƒ¼ãƒ‰é–‹ç™º',
                icon: 'ğŸ’»',
                template: 'ä»¥ä¸‹ã®ä»•æ§˜ã§ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„',
                structure: ['æ©Ÿèƒ½è¦ä»¶', 'æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯', 'å®Ÿè£…æ–¹é‡', 'ãƒ†ã‚¹ãƒˆè¨ˆç”»']
            },
            brainstorm: {
                name: 'ã‚¢ã‚¤ãƒ‡ã‚¢å‡ºã—',
                icon: 'ğŸ’¡',
                template: 'ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒã§ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ææ¡ˆã—ã¦ãã ã•ã„',
                structure: ['èƒŒæ™¯ã¨ç›®çš„', 'åˆ¶ç´„æ¡ä»¶', 'ã‚¢ã‚¤ãƒ‡ã‚¢åŸºæº–', 'æœŸå¾…ã™ã‚‹æ•°']
            },
            review: {
                name: 'ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»è©•ä¾¡',
                icon: 'ğŸ”',
                template: 'ä»¥ä¸‹ã«ã¤ã„ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãŠé¡˜ã„ã—ã¾ã™',
                structure: ['ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾è±¡', 'è©•ä¾¡è¦³ç‚¹', 'æ”¹å–„ææ¡ˆ', 'å„ªå…ˆé †ä½']
            },
            custom: {
                name: 'ã‚«ã‚¹ã‚¿ãƒ ',
                icon: 'âš™ï¸',
                template: 'ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„',
                structure: ['ã‚¿ã‚¹ã‚¯å†…å®¹', 'åˆ¶ç´„æ¡ä»¶', 'æˆæœç‰©', 'æœŸé™']
            },
            troubleshoot: {
                name: 'å•é¡Œè§£æ±º',
                icon: 'ğŸ”§',
                template: 'ä»¥ä¸‹ã®å•é¡Œã«ã¤ã„ã¦åŸå› åˆ†æã¨è§£æ±ºç­–ã‚’æç¤ºã—ã¦ãã ã•ã„',
                structure: ['å•é¡Œã®è©³ç´°', 'ã‚¨ãƒ©ãƒ¼å†…å®¹', 'è©¦ã—ãŸå¯¾å‡¦æ³•', 'ç’°å¢ƒæƒ…å ±']
            }
        };

        // Load basic instructions on page load
        function loadBasicInstructions() {
            try {
                const savedData = localStorage.getItem('aiProjectBuilderData');
                if (savedData) {
                    basicInstructions = JSON.parse(savedData);
                    
                    // Show notice
                    if (basicInstructions.projectName) {
                        document.getElementById('basicInstructionsNotice').classList.remove('hidden');
                        document.getElementById('loadedProjectName').textContent = basicInstructions.projectName;
                        
                        // Show project type info
                        if (basicInstructions.projectType && projectTaskMapping[basicInstructions.projectType]) {
                            const projectInfo = projectTaskMapping[basicInstructions.projectType];
                            document.getElementById('projectTypeInfo').textContent = `ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¤ãƒ—: ${projectInfo.description}`;
                            document.getElementById('recommendedTasksBadge').classList.remove('hidden');
                            document.getElementById('projectTypeLabel').textContent = projectInfo.description;
                            
                            // Store for later use
                            window.currentProjectType = basicInstructions.projectType;
                        }
                    }
                    
                    return true;
                }
            } catch (e) {
                console.error('Failed to load basic instructions:', e);
            }
            return false;
        }

        // Update task type
        function updateTaskType(type) {
            taskData.type = type;
            
            // Toggle form visibility based on task type
            const regularForm = document.getElementById('regularTaskForm');
            const projectStartForm = document.getElementById('projectStartForm');
            const detailsIcon = document.getElementById('detailsIcon');
            const detailsTitle = document.getElementById('detailsTitle');
            
            if (type === 'project-plan') {
                // Show project plan form
                regularForm.classList.add('hidden');
                projectStartForm.classList.remove('hidden');
                detailsIcon.textContent = 'ğŸ“‹';
                detailsTitle.textContent = 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ç­–å®š';
                
                // Load agents if available
                loadAgentsForProjectStart();
            } else {
                // Show regular task form
                regularForm.classList.remove('hidden');
                projectStartForm.classList.add('hidden');
                detailsIcon.textContent = 'ğŸ“';
                detailsTitle.textContent = 'ã‚¿ã‚¹ã‚¯ã®è©³ç´°';
                
                // Update placeholders based on task type
                if (taskPlaceholders[type]) {
                    const placeholders = taskPlaceholders[type];
                    document.getElementById('taskTitle').placeholder = placeholders.title;
                    document.getElementById('taskDescription').placeholder = placeholders.description;
                    document.getElementById('expectedOutput').placeholder = placeholders.expectedOutput;
                    document.getElementById('context').placeholder = placeholders.context;
                }
            }
            
            generatePrompt();
        }

        // Generate optimized prompt
        function generatePrompt() {
            // Handle project plan type differently
            if (taskData.type === 'project-plan') {
                const prompt = generateProjectPlanPrompt();
                document.getElementById('promptPreview').innerHTML = `<pre class="whitespace-pre-wrap font-mono text-sm">${escapeHtml(prompt)}</pre>`;
                document.getElementById('copyBtn').disabled = false;
                sessionStorage.setItem('generatedTaskPrompt', prompt);
                return;
            }
            
            // Update task data from form for regular tasks
            taskData.title = document.getElementById('taskTitle').value;
            taskData.description = document.getElementById('taskDescription').value;
            taskData.expectedOutput = document.getElementById('expectedOutput').value;
            taskData.context = document.getElementById('context').value;
            taskData.priority = document.getElementById('priority').value;
            taskData.includeBasicInstructions = document.getElementById('includeBasicInstructions').checked;

            if (!taskData.type || !taskData.title || !taskData.description) {
                return;
            }

            const template = taskTemplates[taskData.type] || taskTemplates.custom;
            let prompt = '';

            // Add priority indicator if high
            if (taskData.priority === 'high') {
                prompt += 'ğŸš¨ **å„ªå…ˆåº¦: é«˜** - ã“ã®ã‚¿ã‚¹ã‚¯ã¯ç·Šæ€¥ã§ã™\n\n';
            }

            // Add task header
            prompt += `# ${template.icon} ${taskData.title}\n\n`;

            // Add basic instructions reference if enabled
            if (taskData.includeBasicInstructions && basicInstructions) {
                prompt += `## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ\n`;
                prompt += `ã“ã®ã‚¿ã‚¹ã‚¯ã¯ã€Œ**${basicInstructions.projectName}**ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸€éƒ¨ã§ã™ã€‚\n`;
                
                // Add project type context
                if (basicInstructions.projectType && projectTaskMapping[basicInstructions.projectType]) {
                    const projectInfo = projectTaskMapping[basicInstructions.projectType];
                    prompt += `ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¤ãƒ—: **${projectInfo.description}**\n`;
                }
                
                if (basicInstructions.projectDescription) {
                    prompt += `\n${basicInstructions.projectDescription}\n`;
                }
                
                prompt += `\nåŸºæœ¬çš„ãªå½¹å‰²ã¨ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã¤ã„ã¦ã¯ã€æ—¢ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹æŒ‡ç¤ºã«å¾“ã£ã¦ãã ã•ã„ã€‚\n\n`;
            }

            // Add task description
            prompt += `## ã‚¿ã‚¹ã‚¯å†…å®¹\n`;
            prompt += `${taskData.description}\n\n`;

            // Add expected output if specified
            if (taskData.expectedOutput) {
                prompt += `## æœŸå¾…ã™ã‚‹æˆæœç‰©\n`;
                prompt += `${taskData.expectedOutput}\n\n`;
            }

            // Add context if provided
            if (taskData.context) {
                prompt += `## å‚è€ƒæƒ…å ±ãƒ»ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ\n`;
                prompt += `${taskData.context}\n\n`;
            }

            // Add task-specific structure
            if (template.structure && template.structure.length > 0) {
                prompt += `## æ¨å¥¨ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ\n`;
                prompt += `ä»¥ä¸‹ã®è¦³ç‚¹ã‚’è€ƒæ…®ã—ã¦ãã ã•ã„ï¼š\n`;
                template.structure.forEach((item, index) => {
                    prompt += `${index + 1}. ${item}\n`;
                });
                prompt += '\n';
            }

            // Add priority-based instruction
            if (taskData.priority === 'high') {
                prompt += `## æ³¨æ„äº‹é …\n`;
                prompt += `- ã“ã®ã‚¿ã‚¹ã‚¯ã¯å„ªå…ˆåº¦ãŒé«˜ã„ãŸã‚ã€è¿…é€Ÿã‹ã¤æ­£ç¢ºãªå¯¾å¿œã‚’ãŠé¡˜ã„ã—ã¾ã™\n`;
                prompt += `- ä¸æ˜ãªç‚¹ãŒã‚ã‚Œã°ã€ã™ãã«ç¢ºèªã—ã¦ãã ã•ã„\n\n`;
            } else if (taskData.priority === 'low') {
                prompt += `## æ³¨æ„äº‹é …\n`;
                prompt += `- ã“ã®ã‚¿ã‚¹ã‚¯ã¯å„ªå…ˆåº¦ãŒä½ã„ãŸã‚ã€ä»–ã®ç·Šæ€¥ã‚¿ã‚¹ã‚¯ã‚’å„ªå…ˆã—ã¦ãã ã•ã„\n`;
                prompt += `- æ™‚é–“ã‚’ã‹ã‘ã¦ä¸å¯§ã«å–ã‚Šçµ„ã‚“ã§ãã ã•ã„\n\n`;
            }

            // Add footer
            prompt += `---\n`;
            prompt += `ç”Ÿæˆæ—¥æ™‚: ${new Date().toLocaleString('ja-JP')}\n`;
            if (basicInstructions && basicInstructions.multiAgent) {
                prompt += `ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰: ${basicInstructions.agents ? basicInstructions.agents.length : 0}åã®å°‚é–€å®¶\n`;
            }

            // Display the generated prompt
            document.getElementById('promptPreview').innerHTML = `<pre class="whitespace-pre-wrap font-mono text-sm">${escapeHtml(prompt)}</pre>`;
            document.getElementById('copyBtn').disabled = false;

            // Save to session
            sessionStorage.setItem('generatedTaskPrompt', prompt);
            
            // Show usage guide
            showUsageGuide(taskData.type);
        }
        
        // Show usage guide based on task type
        function showUsageGuide(taskType) {
            const guide = usageGuides[taskType] || usageGuides.custom;
            const guideSection = document.getElementById('usageGuideSection');
            const guideContent = document.getElementById('usageGuide');
            const defaultHint = document.getElementById('defaultHint');
            
            // Build guide HTML
            let guideHTML = `<h5 class="font-medium mb-2">${guide.title}</h5>`;
            guideHTML += '<ol class="list-decimal list-inside space-y-1 mb-3">';
            guide.steps.forEach(step => {
                guideHTML += `<li>${step}</li>`;
            });
            guideHTML += '</ol>';
            if (guide.tip) {
                guideHTML += `<p class="mt-3 text-amber-700 bg-amber-50 p-2 rounded">${guide.tip}</p>`;
            }
            
            // Update content and show
            guideContent.innerHTML = guideHTML;
            guideSection.classList.remove('hidden');
            defaultHint.classList.add('hidden');
        }

        // Copy prompt to clipboard
        function copyPrompt() {
            const prompt = sessionStorage.getItem('generatedTaskPrompt');
            if (prompt) {
                navigator.clipboard.writeText(prompt).then(() => {
                    const btn = document.getElementById('copyBtn');
                    const originalText = btn.textContent;
                    btn.textContent = 'âœ“ ã‚³ãƒ”ãƒ¼æ¸ˆã¿';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 2000);
                });
            }
        }

        // Save task
        function saveTask() {
            if (!taskData.title || !taskData.description) {
                alert('ã‚¿ã‚¹ã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ã¨å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            try {
                // Get existing tasks
                let tasks = JSON.parse(localStorage.getItem('aiProjectBuilderTasks') || '[]');
                
                // Add new task
                const newTask = {
                    id: `task-${Date.now()}`,
                    projectId: basicInstructions ? basicInstructions.projectName : 'unknown',
                    ...taskData,
                    prompt: sessionStorage.getItem('generatedTaskPrompt') || '',
                    created: new Date().toISOString()
                };
                
                tasks.push(newTask);
                
                // Save to localStorage
                localStorage.setItem('aiProjectBuilderTasks', JSON.stringify(tasks));
                
                alert('ã‚¿ã‚¹ã‚¯ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            } catch (e) {
                alert('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + e.message);
            }
        }

        // Escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Load agents for project start mode
        function loadAgentsForProjectStart() {
            if (!basicInstructions || !basicInstructions.agents || basicInstructions.agents.length === 0) {
                document.getElementById('agentTasksSection').classList.add('hidden');
                return;
            }
            
            document.getElementById('agentTasksSection').classList.remove('hidden');
            const agentTasksList = document.getElementById('agentTasksList');
            agentTasksList.innerHTML = '';
            
            basicInstructions.agents.forEach((agent, index) => {
                const agentDiv = document.createElement('div');
                agentDiv.className = 'p-3 bg-gray-50 rounded-lg';
                agentDiv.innerHTML = `
                    <h5 class="font-medium text-sm text-gray-700 mb-1">${agent.icon || 'ğŸ‘¤'} ${agent.name || 'ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ'}</h5>
                    <p class="text-xs text-gray-500 mb-2">${agent.role || ''}</p>
                    <textarea 
                        id="agentTask-${index}" 
                        class="w-full px-3 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 text-sm"
                        placeholder="ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ä¾é ¼ã™ã‚‹åˆæœŸã‚¿ã‚¹ã‚¯ã‚’å…¥åŠ›..."
                                            ></textarea>
                `;
                agentTasksList.appendChild(agentDiv);
            });
        }

        // Generate project plan prompt
        function generateProjectPlanPrompt() {
            const projectName = basicInstructions?.projectName || 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ';
            const projectDescription = basicInstructions?.projectDescription || '';
            const projectGoals = basicInstructions?.projectGoals || '';
            const projectType = basicInstructions?.projectType || '';
            const deadline = document.getElementById('projectDeadline').value;
            const techRequirements = document.getElementById('techRequirements').value;
            const constraints = document.getElementById('projectConstraints').value;
            const references = document.getElementById('projectReferences').value;
            
            let prompt = `# ğŸ“‹ ${projectName} - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ç­–å®š\n\n`;
            
            prompt += `## ç›®çš„\n`;
            prompt += `ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°ãªå®Ÿè¡Œè¨ˆç”»ã‚’ç­–å®šã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®è¦³ç‚¹ã‹ã‚‰åŒ…æ‹¬çš„ãªè¨ˆç”»ã‚’ä½œæˆã—ã€å®Ÿè¡Œå¯èƒ½ãªã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æç¤ºã—ã¦ãã ã•ã„ã€‚\n\n`;
            
            // Add project type specific guidance
            if (projectType) {
                const projectTypePlanningGuides = {
                    business: 'ãƒ“ã‚¸ãƒã‚¹æˆæœã¸ã®å½±éŸ¿ã€ROIã€ãƒªã‚¹ã‚¯ç®¡ç†ã‚’ç‰¹ã«é‡è¦–ã—ã¦è¨ˆç”»ã—ã¦ãã ã•ã„ã€‚',
                    creative: 'å‰µé€ çš„ãƒ—ãƒ­ã‚»ã‚¹ã€ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æºã€å“è³ªç®¡ç†ã‚’é‡è¦–ã—ã¦è¨ˆç”»ã—ã¦ãã ã•ã„ã€‚',
                    technical: 'æŠ€è¡“çš„èª²é¡Œã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆã€ãƒ†ã‚¹ãƒˆè¨ˆç”»ã‚’é‡è¦–ã—ã¦è¨ˆç”»ã—ã¦ãã ã•ã„ã€‚',
                    research: 'èª¿æŸ»æ–¹æ³•è«–ã€ãƒ‡ãƒ¼ã‚¿åé›†è¨ˆç”»ã€åˆ†ææ‰‹æ³•ã‚’é‡è¦–ã—ã¦è¨ˆç”»ã—ã¦ãã ã•ã„ã€‚',
                    personal: 'å€‹äººã®ç›®æ¨™ã€åˆ©ç”¨å¯èƒ½ãªæ™‚é–“ã€ãƒ©ã‚¤ãƒ•ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è€ƒæ…®ã—ã¦è¨ˆç”»ã—ã¦ãã ã•ã„ã€‚',
                    custom: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç‰¹æ®Šæ€§ã‚’è€ƒæ…®ã—ã¦æŸ”è»Ÿã«è¨ˆç”»ã—ã¦ãã ã•ã„ã€‚'
                };
                
                const planningGuide = projectTypePlanningGuides[projectType];
                if (planningGuide) {
                    prompt += `**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸæ³¨æ„ç‚¹**: ${planningGuide}\n\n`;
                }
            }
            
            if (projectDescription) {
                prompt += `## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦\n${projectDescription}\n\n`;
            }
            
            if (projectGoals) {
                prompt += `## ç›®æ¨™ãƒ»ã‚´ãƒ¼ãƒ«\n${projectGoals}\n\n`;
            }
            
            if (deadline) {
                prompt += `## æœŸé™ãƒ»ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³\n${deadline}\n\n`;
            }
            
            // Add team composition if agents exist
            if (basicInstructions?.agents && basicInstructions.agents.length > 0) {
                prompt += `## ãƒãƒ¼ãƒ æ§‹æˆã¨ã‚¿ã‚¹ã‚¯å‰²ã‚Šå½“ã¦\n\n`;
                basicInstructions.agents.forEach((agent, index) => {
                    const taskElement = document.getElementById(`agentTask-${index}`);
                    const task = taskElement ? taskElement.value : '';
                    
                    if (task) {
                        prompt += `### ${agent.icon || 'ğŸ‘¤'} ${agent.name}\n`;
                        prompt += `**å°‚é–€åˆ†é‡**: ${agent.role}\n`;
                        prompt += `**æ‹…å½“ã‚¿ã‚¹ã‚¯**: ${task}\n\n`;
                    }
                });
            }
            
            // Add additional information
            if (techRequirements || constraints || references) {
                prompt += `## è¿½åŠ æƒ…å ±\n\n`;
                if (techRequirements) {
                    prompt += `**å¿…è¦ãªãƒªã‚½ãƒ¼ã‚¹ãƒ»æº–å‚™**: ${techRequirements}\n\n`;
                }
                if (constraints) {
                    prompt += `**æ³¨æ„ç‚¹ãƒ»åˆ¶ç´„äº‹é …**: ${constraints}\n\n`;
                }
                if (references) {
                    prompt += `**å‚è€ƒè³‡æ–™**: ${references}\n\n`;
                }
            }
            
            prompt += `## æœŸå¾…ã™ã‚‹æˆæœç‰©\n\n`;
            prompt += `ä»¥ä¸‹ã®å†…å®¹ã‚’å«ã‚€å®Ÿè¡Œå¯èƒ½ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨ˆç”»ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š\n\n`;
            prompt += `1. **ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®è¡Œå‹•è¨ˆç”»**: ç›®æ¨™é”æˆã¾ã§ã®å…·ä½“çš„ãªæ‰‹é †\n`;
            prompt += `2. **å®Ÿè¡Œã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ**: ã™ãã«å§‹ã‚ã‚‰ã‚Œã‚‹å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå„ªå…ˆåº¦ä»˜ãï¼‰\n`;
            prompt += `3. **é‡è¦ãªæ±ºå®šãƒã‚¤ãƒ³ãƒˆ**: ã„ã¤ä½•ã‚’æ±ºã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹\n`;
            prompt += `4. **ãƒªã‚¹ã‚¯ã¨å¯¾ç­–**: æƒ³å®šã•ã‚Œã‚‹å•é¡Œã¨äºˆé˜²ãƒ»å¯¾å‡¦æ³•\n`;
            prompt += `5. **ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ**: é€²æ—ç¢ºèªã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨æ–¹æ³•\n`;
            prompt += `6. **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¡ˆ**: ç¾å®Ÿçš„ãªæœŸé™è¨­å®šï¼ˆãƒãƒƒãƒ•ã‚¡å«ã‚€ï¼‰\n\n`;
            prompt += `è¨ˆç”»ã¯èª°ã§ã‚‚ç†è§£ã§ãã€ã™ãã«è¡Œå‹•ã«ç§»ã›ã‚‹å…·ä½“çš„ãªå†…å®¹ã«ã—ã¦ãã ã•ã„ã€‚`;
            
            return prompt;
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            loadBasicInstructions();
            
            // Add event listeners to task type radio buttons
            document.querySelectorAll('input[name="taskType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    updateTaskType(this.value);
                });
            });
            
            // Add event listeners for form fields
            const formFields = ['taskTitle', 'taskDescription', 'expectedOutput', 'context', 
                               'projectDeadline', 'techRequirements', 'projectConstraints', 
                               'projectReferences', 'includeBasicInstructions', 'priority'];
            
            formFields.forEach(fieldId => {
                const element = document.getElementById(fieldId);
                if (element) {
                    element.addEventListener(element.type === 'checkbox' ? 'change' : 'input', generatePrompt);
                }
            });
            
            // Highlight recommended tasks based on project type
            if (window.currentProjectType && projectTaskMapping[window.currentProjectType]) {
                const recommendedTasks = projectTaskMapping[window.currentProjectType].recommended;
                recommendedTasks.forEach(taskType => {
                    const taskCard = document.querySelector(`[data-task-type="${taskType}"]`);
                    if (taskCard) {
                        const badge = taskCard.querySelector('.recommended-badge');
                        if (badge) {
                            badge.classList.remove('hidden');
                        }
                        // Add subtle highlight
                        taskCard.classList.add('ring-2', 'ring-green-200');
                    }
                });
            }
            
            // Check URL parameters for mode
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode');
            
            if (mode === 'project-start' || mode === 'project-plan') {
                // Auto-select project plan type (supporting old URL for compatibility)
                document.querySelector('input[name="taskType"][value="project-plan"]').checked = true;
                updateTaskType('project-plan');
            }
        });
    </script>
</body>
</html>